\documentclass[12 pt]{article}
\hbadness=10


\usepackage{amsmath, amssymb, amsfonts, setspace, stmaryrd, amsthm, graphicx, tikz}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usetikzlibrary{positioning}% To get more advanced positioning options
\usetikzlibrary{arrows}% To get more arrow heads
\usepackage{hyperref} % Allows to make references and links clickable

\usepackage[margin=1.5in]{geometry}
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
%%align* environment
\newcommand{\eq}[1]{\begin{align*}#1\end{align*}}

%Math commands
\DeclareMathOperator{\R}{\mathbb{R}}
\DeclareMathOperator{\C}{\mathbb{C}}
\DeclareMathOperator{\Z}{\mathbb{Z}}
\DeclareMathOperator{\N}{\mathbb{N}}
\DeclareMathOperator{\Q}{\mathbb{Q}}

%Crypto commands
\usepackage{cryptocode}
\newcommand{\sample}{\hskip2.3pt{\gets\!\!\mbox{\tiny${\$}$\normalsize}}\,}
\def\D{\ensuremath{\mathcal{D}}}
\def\A{\ensuremath{\mathcal{A}}}
\def\ss{\ensuremath{\mathcal{S}}}
\def\bin{\ensuremath{\{0, 1\}}}

%comments
\newcommand{\nsm}[1]{\textcolor{teal}{(NG: #1)}}
\newcommand{\new}[1]{\textcolor{blue}{#1}}
\newcommand{\todo}[1]{\textcolor{red}{#1}}

\newcounter{answer}[section]
\newenvironment{answer}{%
\refstepcounter{answer}
\par\bigskip 
\begin{quotation}{}{\leftmargin .25in\rightmargin .25in}
    \noindent \textbf{Answer~\thesection.\theanswer }  \rmfamily}
{\end{quotation}\par\bigskip}

\newenvironment{bonus}{%
\refstepcounter{answer}
\par\bigskip 
\begin{quotation}{}{\leftmargin .25in\rightmargin .25in}
    \noindent \textbf{*Bonus Answer*~\thesection.\theanswer }  \rmfamily}
{\end{quotation}\par\bigskip}

\newenvironment{sampleA}{%
\refstepcounter{answer}
\par\bigskip 
\begin{quotation}{}{\leftmargin .25in\rightmargin .25in}
    \noindent \textbf{Sample Answer~\thesection.\theanswer }  \rmfamily}
{\end{quotation}\par\bigskip}

\def\share{\ensuremath{\mathsf{Share}}}
\def\rec{\ensuremath{\mathsf{Rec}}}

\title{Cryptographic Secret Sharing\\
    \textbf{ANSWER KEY}}
\author{Girls Talk Math}
\date{}

\begin{document}
\maketitle

\section{Probability and Randomness}

\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item Sample space: 
        \[
            \{A\diamondsuit, 2\diamondsuit, 3\diamondsuit, \ldots, K\diamondsuit, 
            A\heartsuit,\ldots,K\heartsuit,
            A\spadesuit,\ldots,K\spadesuit,
            A\clubsuit,\ldots,K\clubsuit\}  
        \]
        Probability distribution: 
        \[
            \left\{\frac{1}{52}, \ldots, \frac{1}{52}\right\} 
        \]
        (where $\frac{1}{52}$ is repeated 52 times).
        \item Sample space:
        \[
            \{\text{registered}, \text{not registered}\}
        \]
        Probability distribution:
        \[
            \{0.95, 0.05\}
        \]
    \end{enumerate}
\end{answer}

\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item \textbf{Uniform.} The deck is shuffled, so a card is equally likely 
        to be in any one place in the deck.
        \item \textbf{Not uniform.} You are more likely to draw a lower card if 
        you draw from the beginning of the deck instead of the end.
        \item \textbf{Not uniform.} Though it fluctuates, weather generally follows 
        large-scale patterns that depend on the season, latitude and longitude,
        the air masses present, and so on. This is called climate. The reason 
        meteoroligists can predict the weather is precisely because it is 
        not a uniformly random variable.
        \item \textbf{Uniform.} Every number is equally likely to be rolled.
        \item \textbf{Not uniform.} In fact, some birthdays are more likely to occur 
        than others. Summer birthdays are slightly more common, for instance.\footnotemark
        \footnotetext{You can see a visualization of the probability of each 
        birthday here: \url{http://thedailyviz.com/2016/09/17/how-common-is-your-birthday-dailyviz/}.}
    \end{enumerate}
\end{answer}

\begin{answer}
    $d \sample \{1, 2, 3, 4, 5, 6\}$. (You could have chosen any name for the variable in the place of $d$.)
\end{answer}

\begin{answer}
    \color{blue} % new
    To find $\Pr[B \mid A]$, we simply switch the places of $A$ and $B$ 
    in the formula:
    \[
        \Pr[B \mid A] = \frac{\Pr[A \text{ and } B]}{\Pr[A]}
    \]
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item 0; $B$ takes up none of $A$'s space.
        \item $\frac{1}{16} \div \frac{1}{8} = \frac{1}{2}$; $B$ overlaps 
        with half of $A$.
        \item $\frac{1}{8} \div \frac{1}{8} = 1$; $B$ covers $A$, so if our 
        outcome is in $A$, it is certainly in $B$.
    \end{enumerate}
\end{answer}

\begin{answer}
    Let $c_1$ and $c_2$ be random variables representing the first and second
    coin toss, respectively. Since the coin tosses are independent, 
    \begin{align*}
        & \Pr[c_1=H \text{ and } c_2=H]\\
        =& \Pr[c_1=H] \cdot \Pr[c_2=H]\\
        =& \frac{1}{2} \cdot \frac{1}{2} = \frac{1}{4}
    \end{align*}
\end{answer}

\begin{answer}
    There are two ways of getting one heads outcome: (1) the first toss is heads 
    ($c_1=H$), and we don't do another coin toss, or (2) the first toss comes up tails,
    and the second one comes up heads ($c_1=T$ and $c_2=H$). 
    
    \begin{align*}
        & \Pr[c_1=H] + \Pr[c_1=T \text{ and } c_2=H]\\
        =& \Pr[c_1=H] + \Pr[c_2=H] \cdot \Pr[c_1=T] 
        \tag{coin tosses are independent events}\\
        =& \frac{1}{2} + \frac{1}{2}\cdot\frac{1}{2}\\
        =& \frac{1}{2} + \frac{1}{4}\\
        =& \frac{3}{4}
    \end{align*}
\end{answer}

\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item Rolling an even number means rolling 2, 4, \textbf{or} 6, each 
        of which happen with probability $\frac{1}{6}$, so the probability of 
        rolling and even number is $\frac{1}{6}+\frac{1}{6}+\frac{1}{6}=\frac{1}{2}$.

        Another way to see this is that our roll has to land in the set 
        $\{2,4,6\}$ and not in $\{1,3,5\}$. Because even number happens 
        with equal probability and the sets are of equal size, the dice 
        roll lands in each of the two sets with equal probability. So landing 
        in one set happens with probability $\frac{1}{2}$.
        \item This happens if the first roll is a 1 \textbf{and} the second roll 
        is a 2. Each of those occurs with probability $\frac{1}{6}$, so the 
        answer is $\frac{1}{6}\cdot \frac{1}{6} = \frac{1}{6\cdot6}=\frac{1}{36}$.
        \item This can be broken down into cases based on the first roll:
        \begin{align*}
            &\Pr[\text{roll} > 1 \mid \text{first roll is }1]\cdot\Pr[\text{first roll is }1]\\
            &+\Pr[\text{roll} > 2 \mid \text{first roll is }2]\cdot\Pr[\text{first roll is }2]\\
            &+\Pr[\text{roll} > 3 \mid \text{first roll is }3]\cdot\Pr[\text{first roll is }3]\\
            &+\Pr[\text{roll} > 4 \mid \text{first roll is }4]\cdot\Pr[\text{first roll is }4]\\
            &+\Pr[\text{roll} > 5 \mid \text{first roll is }5]\cdot\Pr[\text{first roll is }5]\\
            &+\Pr[\text{roll} > 6 \mid \text{first roll is }6]\cdot\Pr[\text{first roll is }6]\\
        \end{align*}
        \begin{align*}
            =&\Pr[\text{roll} > 1]\cdot \frac{1}{6}
            +\Pr[\text{roll} > 2]\cdot \frac{1}{6}\\
            &+\Pr[\text{roll} > 3]\cdot \frac{1}{6}
            +\Pr[\text{roll} > 4]\cdot \frac{1}{6}\\
            &+\Pr[\text{roll} > 5\cdot] \frac{1}{6}
            +\Pr[\text{roll} > 6]\cdot \frac{1}{6}\\
            =& \frac{1}{6} \left(
                \frac{5}{6}+\frac{4}{6}+\frac{3}{6}+\frac{2}{6}+\frac{1}{6}+0
            \right)\\
            =& \frac{1}{6} \left( \frac{15}{6}\right)\\
            =& \frac{1}{6} \cdot \frac{5}{2} = \frac{5}{12}
        \end{align*}
        \item Either I roll a 5 or 6 on my first roll, or I roll a 1 and my second roll is 
        a 5 or 6:
        \begin{align*}
            &\Pr[\text{first roll is }5]
            +\Pr[\text{first roll is }6]\\
            &+\left(\Pr[\text{second roll is }5 \mid \text{first roll is }1]+
            \Pr[\text{second roll is }6 \mid \text{first roll is }1]\right)\\
            &\cdot\Pr[\text{first roll is }1]\\
            =&\frac{1}{6}+\frac{1}{6}+\left(\frac{1}{6}+\frac{1}{6}\right)\frac{1}{6}\\
            =&\frac{1}{3}+\left(\frac{1}{3}\right)\frac{1}{6}\\
            =&\frac{1}{3}+\frac{1}{18}\\
            =&\frac{7}{18}
        \end{align*}
    \end{enumerate}
\end{answer}

\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})}
    \begin{enumerate}
        \item \textbf{indistinguishable:} 
        both $\left\{\frac{1}{2},\frac{1}{2}\right\}$
        \item \textbf{not indistinguishable:}
        the uniform distribution with all probabilities equal to 
        $\frac{1}{52}$ is not the same as the uniform distribution 
        with all probabilities $\frac{1}{6}\left(\frac{1}{2}\right)^3 
        = \frac{1}{48}$.
        \item \textbf{indistinguishable:}
        $\left\{\frac{1}{4},3\left(\frac{1}{4}\right)\right\} 
        = \left\{\frac{13}{52},\frac{39}{52}\right\} 
        = \left\{\frac{1}{4},\frac{3}{4}\right\}$
    \end{enumerate}
\end{answer}

\section{Secret Sharing}

\subsection{A simple secret sharing}
\begin{sampleA}
    Note that for any secret $s$ there are many possible answers based on the 
    randomness $s_1$ that's used. 
    
    An example application of \share~with $s=42$ follows. First, $s_1$ is 
    chosen at random. Say $s_1=18$. Then \share~outputs $(18,42-18)=(18,24)$.

    $s_1$ could also be larger than $s$, e.g. $s_1 = 321$. In this case, 
    \share~outputs $(321,42-321)=(42,-279)$.
\end{sampleA}

\begin{answer}
    Reconstruction simply adds the shares together:
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item $2+6=8$
        \item $4+1=5$
        \item $10+2=12$
        \item $115+(-103)=12$
        \item $559+(-544)=15$
    \end{enumerate}
\end{answer}

\begin{answer} Additive secret sharing with 3 shares:
    \begin{pchstack}[center]
    \fbox{%
    \procedure{$\share(s)$}{%
        s_1, s_2 \sample \{1, \ldots, 2^\lambda\} \\
        s_3 = s - (s_1+s_2)\\
        \textsf{return}~ (s_1, s_2, s_3)
    }
    \pchspace
    \procedure{$\rec(s_1, s_2, s_3)$}{%
        \textsf{return}~ s_1 + s_2 + s_3
    }
    }
    \end{pchstack}

    In fact, the additive secret sharing scheme can be adapted to share 
    the secret $s$ into any natural number $n$ of shares:
    \begin{pchstack}[center]
    \fbox{%
    \procedure{$\share(s)$}{%
        s_1, \ldots, s_{n-1} \sample \{1, \ldots, 2^\lambda\} \\
        s_n = s - (s_1+\ldots+s_{n-1})\\
        \textsf{return}~ (s_1, \ldots, s_n)
    }
    \pchspace
    \procedure{$\rec(s_1, \ldots, s_n)$}{%
        \textsf{return}~ s_1 + \ldots + s_n
    }
    }
    \end{pchstack}

    \new{(If $\rec$ is run on the incorrect number of shares---anything except 
    3 and $n$, respectively---the algorithms return $\perp$.)}
\end{answer}

\subsection{Formal Definitions*}
\begin{sampleA}
    The adversary should only be able to win about half the time. This is 
    because $s_i$ looks random to the adversary. The key part of the scheme 
    is that $s_1$ is chosen uniformly at random, thereby making both $s_1$ 
    and $s_2$ uniformly distributed and independent of $s$.
\end{sampleA}

\begin{answer}
    No. There is an adversary $\A$ whose advantage in the privacy game 
    is not small. 
    
    $\A$ works as follows: it chooses values $x_0, x_1$ such that $x_0$ 
    is even and $x_1$ is odd (the opposite works too) and lets $i=1$. 
    When the game sends it the share $s_1$, $\A$ checks if $s_1 < 2^\lambda/2$. 
    If so, it outputs $b'=0$; otherwise, it outputs $b'=1$.

    $\A$ wins the game with probability $3/4$:

    \begin{align*}
        \Pr[\text{SS-priv}_{\A,\ss}(t,n) = 1] \\
        =& \Pr[b'=b \mid b=0] + \Pr[b'=b \mid b=1]\\
        =& \frac{1}{2}\left(1\right) + \frac{1}{2}\left(\frac{1}{2}\right)\\
        =& \frac{1}{2} + \frac{1}{4} = \frac{3}{4}
    \end{align*}
    \smallskip

    So $\A$'s advantage is $\frac{3}{4}-\frac{1}{2} = \frac{1}{4}$, which 
    is not small.
\end{answer}

% \subsection{Proving Security*}

\section{Shamir's Secret Sharing}

\subsection{Polynomials}
\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item degree: 2, $y$-intercept: -1
        \item degree: 2, $y$-intercept: 11
        \item degree: 3, $y$-intercept: 0
        \item degree: 5, $y$-intercept: -15
        \item degree: 3 ($=2+1$), $y$-intercept: -3 ($=-1 \cdot 3$)
        \item degree: 3 ($=1+1+1$), $y$-intercept: 120 ($=2 \cdot -6 \cdot 2 \cdot -5$) 
        \item degree: 4 ($=3+1$), $y$-intercept: 32 ($=2 \cdot 16$)
    \end{enumerate}
\end{answer}

\newcommand{\hide}[1]{\textcolor{white}{#1}\vspace{-6em}}
% \subsubsection{Uniqueness}
\hide{\subsubsection{Uniqueness}}
\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})} 
    \begin{enumerate}
        \item 3
        \item 3
        \item 4
        \item 6
        \item 4
        \item 4
        \item 5
    \end{enumerate}
\end{answer}

\subsubsection{Lagrange Interpolation*}
\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})}
    \begin{enumerate}
        \item $2(1) + 2(2) + 2(3) + 2(4) + 2(5) = 2(1+2+3+4+5) = 2(15) = 30$
        \item $1+1+1+1+1 = 5(1) = 5$
        \item $1+5+(-3)+0+8 = 11$
        \item $1+5+(-3)=3$
    \end{enumerate}
\end{answer}

\begin{answer}
    \renewcommand{\labelenumi}{(\alph{enumi})}
    \begin{enumerate}
        \item $2(1) \cdot 2(2) \cdot 2(3) \cdot 2(4) \cdot 2(5) = 2^5\cdot1\cdot2\cdot3\cdot4\cdot5 
        = 32\cdot120 = 3840$
        \item $1\cdot1\cdot1\cdot1\cdot1 = 1$
        \item $1\cdot5\cdot(-3)\cdot0\cdot8 = 0$
        \item $1\cdot5\cdot(-3) = -15$
    \end{enumerate}
\end{answer}

\begin{answer}
    $3x^2 + 7x - 12$
\end{answer}

\begin{answer}
    N/A
\end{answer}

\begin{answer}
    N/A
\end{answer}

\hide{\subsection{Sharing Secrets Using Polynomials}}

\end{document}